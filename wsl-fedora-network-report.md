# WSL Fedora 42 System Network Configuration Report
Generated: 2025-09-04

## System Overview

### Host Information
- **Hostname**: KBC-JJOHNSON47.ua.ad.alaska.edu
- **Domain**: ua.ad.alaska.edu (University of Alaska)
- **Operating System**: Fedora Linux 42 (Container Image)
- **Kernel**: 6.6.87.2-microsoft-standard-WSL2
- **Architecture**: x86_64
- **WSL Version**: 2.5.10.0
- **Windows Version**: 10.0.26100.4946 (Windows 11)

### User Context
- **Username**: verlyn13
- **UID/GID**: 1000/1000
- **Groups**: verlyn13(1000), adm(4), wheel(10), cdrom(11)
- **Sudo Access**: Yes (wheel group)

## Network Configuration

### IP Addressing
- **Internal WSL IP**: 172.17.107.118/20
- **Network**: 172.17.96.0/20
- **Broadcast**: 172.17.111.255
- **Gateway**: 172.17.96.1
- **External IP**: 137.229.236.139 (University of Alaska network)
- **MAC Address**: 00:15:5d:f9:6b:25 (Hyper-V virtual adapter)

### Network Interfaces
1. **lo (Loopback)**
   - IPv4: 127.0.0.1/8
   - IPv4: 10.255.255.254/32 (WSL internal)
   - IPv6: ::1/128
   - MTU: 65536

2. **eth0 (Primary)**
   - IPv4: 172.17.107.118/20
   - IPv6: fe80::215:5dff:fef9:6b25/64 (link-local)
   - MTU: 1280 (reduced from standard 1500)
   - State: UP

### DNS Configuration
- **Primary Nameserver**: 10.255.255.254 (WSL internal resolver)
- **Search Domain**: ua.ad.alaska.edu
- **Note**: DNS is auto-generated by WSL

### Routing
```
default via 172.17.96.1 dev eth0
172.17.96.0/20 dev eth0 scope link src 172.17.107.118
```

## WSL-Specific Configuration

### WSL Settings (/etc/wsl.conf)
- **systemd**: Enabled (full systemd support)
- **interop**: Enabled (Windows interoperability)
- **appendWindowsPath**: True
- **automount**: Enabled with metadata support

### WSL Networking Model
- **Type**: WSL2 with NAT networking
- **Bridge**: Virtual Hyper-V switch
- **Windows Integration**: Full interop enabled
- **TUN Device**: Available at /dev/net/tun (VPN capable)

## Security Assessment

### Current Services
- **SSH Server**: Running on port 22 (0.0.0.0:22)
- **DNS Resolver**: systemd-resolved on multiple ports:
  - 127.0.0.53:53 (stub resolver)
  - 10.255.255.254:53 (WSL resolver)
  - 127.0.0.54:53 (local resolver)
  - 0.0.0.0:5355 (LLMNR)

### Firewall Status
- **iptables**: Not configured (default ACCEPT)
- **IP Forwarding**: Disabled (0)
- **IPv6**: Enabled

### VPN Readiness
- **TUN/TAP Device**: Available and accessible
- **Tailscale**: Not installed
- **WireGuard**: Not installed
- **Current VPN**: None configured

## Tailscale/WireGuard Setup Requirements

### Prerequisites Met
✅ TUN device available (/dev/net/tun)
✅ systemd enabled
✅ sudo access available
✅ IPv4 and IPv6 support
✅ External connectivity confirmed

### Prerequisites Needed
❌ Tailscale package not installed
❌ WireGuard tools not installed
❌ IP forwarding disabled (needs enabling for routing)

### Installation Commands

#### For Tailscale:
```bash
# Add Tailscale repository
curl -fsSL https://pkgs.tailscale.com/stable/fedora/repo.gpg | sudo tee /usr/share/keyrings/tailscale-archive-keyring.gpg
curl -fsSL https://pkgs.tailscale.com/stable/fedora/tailscale.repo | sudo tee /etc/yum.repos.d/tailscale.repo

# Install Tailscale
sudo dnf install -y tailscale

# Enable and start service
sudo systemctl enable --now tailscaled

# Authenticate
sudo tailscale up
```

#### For WireGuard:
```bash
# Install WireGuard tools
sudo dnf install -y wireguard-tools

# Enable IP forwarding (if acting as gateway)
echo 'net.ipv4.ip_forward = 1' | sudo tee -a /etc/sysctl.d/99-wireguard.conf
echo 'net.ipv6.conf.all.forwarding = 1' | sudo tee -a /etc/sysctl.d/99-wireguard.conf
sudo sysctl -p /etc/sysctl.d/99-wireguard.conf
```

## WSL-Specific Considerations

### Networking Limitations
1. **NAT Only**: WSL2 uses NAT networking, not bridged
2. **Dynamic IP**: WSL IP changes on restart
3. **Port Forwarding**: Requires Windows firewall rules for external access
4. **MTU**: Reduced to 1280 (may affect VPN performance)

### Recommended Configurations

#### For Tailscale:
- Use default settings (works well with WSL2)
- Consider `--accept-routes` for full mesh networking
- Enable MagicDNS for internal name resolution

#### For WireGuard:
- Use lower MTU values (1280 or less)
- Consider persistent tunnels with systemd service
- May need Windows firewall exceptions

### Windows Firewall Considerations
To allow inbound connections to WSL:
```powershell
# Run in Windows PowerShell as Administrator
New-NetFirewallRule -DisplayName "WSL2 Tailscale" -Direction Inbound -Protocol UDP -LocalPort 41641 -Action Allow
New-NetFirewallRule -DisplayName "WSL2 WireGuard" -Direction Inbound -Protocol UDP -LocalPort 51820 -Action Allow
```

## Connection to Other Systems

### Target Systems Information Needed
To establish secure tunnels, you'll need from each system:
1. **Tailscale**: Machine name or IP in Tailscale network
2. **WireGuard**: Public key, endpoint IP:port, allowed IPs

### This System's Details for Remote Configuration
- **Public IP**: 137.229.236.139 (University network, may be behind NAT)
- **Local WSL IP**: 172.17.107.118 (changes on restart)
- **Suggested Tailscale Name**: wsl-fedora-kbc
- **WireGuard Listen Port**: 51820 (standard)

## Security Recommendations

1. **Enable Firewall**: Configure iptables or firewalld
2. **Limit SSH**: Consider key-only authentication
3. **VPN Priority**: Tailscale recommended for ease of use with WSL
4. **DNS Security**: Consider DNS-over-HTTPS after VPN setup
5. **Regular Updates**: Keep Fedora 42 updated

## Network Performance Notes

- **Bandwidth**: Limited by WSL2 virtual network adapter
- **Latency**: Additional overhead from Windows→WSL2 translation
- **MTU Issues**: May need tuning for optimal VPN performance
- **CPU**: VPN encryption hardware acceleration not available in WSL

## Troubleshooting Commands

```bash
# Check connectivity
ping -c 4 8.8.8.8
curl -4 ifconfig.me

# Check DNS
nslookup google.com
resolvectl status

# Monitor traffic
sudo tcpdump -i eth0 -n

# Check routes
ip route get 8.8.8.8

# WSL specific
wsl.exe --status
cat /proc/sys/fs/binfmt_misc/WSLInterop
```

## Summary

This WSL2 Fedora 42 system is ready for Tailscale or WireGuard setup with minimal configuration needed. The main considerations are:

1. **WSL2 NAT networking** requires special handling
2. **Dynamic IP assignment** needs consideration for persistent configs
3. **University network** (137.229.x.x) may have restrictions
4. **TUN device available** and working
5. **systemd enabled** for service management

Recommended next steps:
1. Install Tailscale (easier for WSL2)
2. Configure with other systems
3. Test connectivity through mesh network
4. Set up automatic start on WSL boot

---
*Report generated for secure tunnel configuration via Tailscale/WireGuard*
*System: WSL2 Fedora 42 on Windows 11 Host*
*Location: University of Alaska Network*